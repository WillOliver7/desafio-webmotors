# üèéÔ∏è Desafio Webmotors Scraper

Este √© um sistema distribu√≠do em microsservi√ßos para realizar web scraping de an√∫ncios da Webmotors. O sistema permite que usu√°rios se cadastrem, fa√ßam login e acompanhem suas tarefas de coleta de dados de forma isolada.
üèóÔ∏è Arquitetura

O projeto √© composto por:

    Auth Service (Porta 3001): Gerencia usu√°rios e autentica√ß√£o via JWT (Cookies HttpOnly).

    Webscraping Manager (Porta 3003): Gerencia a cria√ß√£o de tarefas, persist√™ncia no banco e fila de processamento.

    Worker (Sidekiq): Processa o scraping em segundo plano.

    Redis: Broker de mensagens para o Sidekiq.

    PostgreSQL: Banco de dados para usu√°rios e tarefas.

    Frontend: Single Page Application (SPA) em JavaScript Puro.

## üöÄ Como Rodar o Projeto
#### 1. Pr√©-requisitos

    Docker

    Docker Compose

#### 2. Configurando as Vari√°veis de Ambiente

Os servi√ßos compartilham uma chave secreta (JWT_SECRET) para garantir que o token gerado por um possa ser lido pelo outro.

###### Como gerar uma chave segura:

Abra o seu terminal e rode o comando abaixo para gerar uma string aleat√≥ria de 64 caracteres:
Bash

ruby -e "require 'securerandom'; puts SecureRandom.hex(64)"

Criando o arquivo .env:
Crie um arquivo chamado .env na raiz do projeto (onde est√° o docker-compose.yml) e cole a chave gerada:

```
JWT_SECRET=cole_a_chave_gerada_aqui
POSTGRES_USER=postgres
POSTGRES_PASSWORD=password
```

#### 3. Subindo os Containers

Na raiz do projeto, execute:
Bash

docker-compose up -d --build

Isso ir√° buildar as imagens, instalar as gems e subir todos os servi√ßos.

#### 4. Preparando o Banco de Dados

Com os containers rodando, voc√™ precisa criar as tabelas nos bancos de dados de autentica√ß√£o e gerenciamento:
Bash

###### Migrations do Auth Service
docker exec -it desafio-webmotors-auth-service-1 bundle exec rails db:create db:migrate

###### Migrations do Webscraping Manager
docker exec -it desafio-webmotors-webscraping-manager-1 bundle exec rails db:create db:migrate

#### 5. Acessando o Projeto

Abra o seu navegador e acesse:

    Frontend: http://localhost:8080 (ou a porta definida no seu servidor est√°tico).

    Sidekiq Dashboard: http://localhost:3003/sidekiq (opcional, se configurado).

üõ†Ô∏è Comandos √öteis

Ver logs do Sidekiq (Worker):
Bash

docker logs -f desafio-webmotors-sidekiq-1

Reiniciar um servi√ßo espec√≠fico:
Bash

docker-compose restart webscraping-manager

Acessar o console do Rails para debug:
Bash

docker exec -it desafio-webmotors-auth-service-1 rails c

üîí Seguran√ßa

    Os tokens de autentica√ß√£o s√£o armazenados em Cookies HttpOnly, protegendo contra ataques XSS.

    Cada usu√°rio s√≥ tem acesso √†s tarefas que ele mesmo criou via escopo de user_id.
