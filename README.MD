ğŸï¸ Desafio Webmotors Scraper

Este Ã© um sistema distribuÃ­do em microsserviÃ§os para realizar web scraping de anÃºncios da Webmotors. O sistema permite que usuÃ¡rios se cadastrem, faÃ§am login e acompanhem suas tarefas de coleta de dados de forma isolada.
ğŸ—ï¸ Arquitetura

O projeto Ã© composto por:

    Auth Service (Porta 3001): Gerencia usuÃ¡rios e autenticaÃ§Ã£o via JWT (Cookies HttpOnly).

    Webscraping Manager (Porta 3003): Gerencia a criaÃ§Ã£o de tarefas, persistÃªncia no banco e fila de processamento.

    Worker (Sidekiq): Processa o scraping em segundo plano.

    Redis: Broker de mensagens para o Sidekiq.

    PostgreSQL: Banco de dados para usuÃ¡rios e tarefas.

    Frontend: Single Page Application (SPA) em JavaScript Puro.

ğŸš€ Como Rodar o Projeto
1. PrÃ©-requisitos

    Docker

    Docker Compose

2. Configurando as VariÃ¡veis de Ambiente

Os serviÃ§os compartilham uma chave secreta (JWT_SECRET) para garantir que o token gerado por um possa ser lido pelo outro.

Como gerar uma chave segura:
Abra o seu terminal e rode o comando abaixo para gerar uma string aleatÃ³ria de 64 caracteres:
Bash

ruby -e "require 'securerandom'; puts SecureRandom.hex(64)"

Criando o arquivo .env:
Crie um arquivo chamado .env na raiz do projeto (onde estÃ¡ o docker-compose.yml) e cole a chave gerada:
Code snippet

JWT_SECRET=cole_a_chave_gerada_aqui
POSTGRES_USER=postgres
POSTGRES_PASSWORD=password

3. Subindo os Containers

Na raiz do projeto, execute:
Bash

docker-compose up -d --build

Isso irÃ¡ buildar as imagens, instalar as gems e subir todos os serviÃ§os.
4. Preparando o Banco de Dados

Com os containers rodando, vocÃª precisa criar as tabelas nos bancos de dados de autenticaÃ§Ã£o e gerenciamento:
Bash

# Migrations do Auth Service
docker exec -it desafio-webmotors-auth-service-1 bundle exec rails db:create db:migrate

# Migrations do Webscraping Manager
docker exec -it desafio-webmotors-webscraping-manager-1 bundle exec rails db:create db:migrate

5. Acessando o Projeto

Abra o seu navegador e acesse:

    Frontend: http://localhost:8080 (ou a porta definida no seu servidor estÃ¡tico).

    Sidekiq Dashboard: http://localhost:3003/sidekiq (opcional, se configurado).

ğŸ› ï¸ Comandos Ãšteis

Ver logs do Sidekiq (Worker):
Bash

docker logs -f desafio-webmotors-sidekiq-1

Reiniciar um serviÃ§o especÃ­fico:
Bash

docker-compose restart webscraping-manager

Acessar o console do Rails para debug:
Bash

docker exec -it desafio-webmotors-auth-service-1 rails c

ğŸ”’ SeguranÃ§a

    Os tokens de autenticaÃ§Ã£o sÃ£o armazenados em Cookies HttpOnly, protegendo contra ataques XSS.

    Cada usuÃ¡rio sÃ³ tem acesso Ã s tarefas que ele mesmo criou via escopo de user_id.